# PopCorn

A web application for tracking movies and TV shows, built with Node.js, Express, and Supabase.

## Features

- User authentication with Supabase Auth
- Search movies and TV shows using TMDb API
- Add media to your personal library
- Track watching status and personal ratings
- Responsive design with Tailwind CSS

## Prerequisites

- Node.js (v14 or higher)
- A Supabase account and project
- A TMDb API key

## Setup

1. Clone the repository:
   ```bash
   git clone <repository-url>
   cd PopCorn
   ```

2. Install dependencies:
   ```bash
   npm install
   ```

3. Create a `.env` file in the root directory with the following variables:
   ```
   SUPABASE_URL=your-project-url
   SUPABASE_ANON_KEY=your-anon-key
   TMDB_API_KEY=your-tmdb-api-key
   PORT=3001
   ```

4. Set up your Supabase database by running the following SQL in the Supabase SQL editor:
   ```sql
   -- Create the media_items table
   CREATE TABLE public.media_items (
     id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
     user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE NOT NULL,
     created_at TIMESTAMPTZ DEFAULT now() NOT NULL,
     api_id VARCHAR(255) NOT NULL,
     media_type VARCHAR(50) NOT NULL,
     title VARCHAR(255) NOT NULL,
     poster_path VARCHAR(255),
     user_rating INT CHECK (user_rating >= 1 AND user_rating <= 5),
     status VARCHAR(50) DEFAULT 'Plan to Watch' NOT NULL
   );

   -- Enable Row Level Security
   ALTER TABLE public.media_items ENABLE ROW LEVEL SECURITY;

   -- Create RLS policies
   CREATE POLICY "Allow individual read access" ON public.media_items
   FOR SELECT USING (auth.uid() = user_id);

   CREATE POLICY "Allow individual insert access" ON public.media_items
   FOR INSERT WITH CHECK (auth.uid() = user_id);

   CREATE POLICY "Allow individual update access" ON public.media_items
   FOR UPDATE USING (auth.uid() = user_id);

   CREATE POLICY "Allow individual delete access" ON public.media_items
   FOR DELETE USING (auth.uid() = user_id);
   ```

5. Update the Supabase credentials in `frontend/js/main.js`:
   ```javascript
   const supabaseUrl = 'your-project-url';
   const supabaseKey = 'your-anon-key';
   ```

6. Start the development server:
   ```bash
   npm run dev
   ```

7. Visit `http://localhost:3001` in your browser.

## Development

- The backend API is in `server.js` and the `routes` directory
- Frontend code is in the `frontend` directory
- Authentication is handled by Supabase
- Database queries use the Supabase client
- Media search uses the TMDb API

## Contributing

1. Fork the repository
2. Create a feature branch
3. Commit your changes
4. Push to the branch
5. Create a Pull Request

## License

This project is licensed under the MIT License. 